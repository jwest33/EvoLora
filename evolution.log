2025-09-20 10:24:16,776 - loralab.config.config_loader - INFO - Loaded configuration from loralab\config\gemma_config.yaml
2025-09-20 10:24:16,777 - loralab.utils.output_manager - INFO - Output manager initialized at: lora_runs_gemma\run_20250920_102416
2025-09-20 10:24:16,777 - loralab.evolution.evolutionary_trainer - INFO - Using unsloth backend
2025-09-20 10:24:16,780 - loralab.utils.output_manager - INFO - Config saved to: lora_runs_gemma\run_20250920_102416\config\config.yaml
2025-09-20 10:24:16,895 - loralab.core.unsloth_manager - INFO - Loading Unsloth model: unsloth/gemma-3-270m-it with none quantization
2025-09-20 10:24:16,895 - loralab.core.unsloth_manager - INFO - Using configured dtype: float16
2025-09-20 10:24:21,995 - loralab.core.unsloth_manager - INFO - Applied chat template: gemma3
2025-09-20 10:24:21,996 - loralab.datasets.dataset_loader - INFO - Loading dataset: gsm8k
2025-09-20 10:24:21,996 - loralab.datasets.dataset_loader - INFO - Fetching gsm8k from HuggingFace...
2025-09-20 10:24:25,540 - loralab.datasets.dataset_loader - INFO - Loaded 2000 training and 100 evaluation examples
2025-09-20 10:24:25,540 - loralab.evolution.evolutionary_trainer - INFO - 
================================================================================
2025-09-20 10:24:25,540 - loralab.evolution.evolutionary_trainer - INFO - STARTING EVOLUTIONARY OPTIMIZATION
2025-09-20 10:24:25,541 - loralab.evolution.evolutionary_trainer - INFO - ================================================================================
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r8_lr1e-04 (hash: 0209a7c3)
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r16_lr5e-05 (hash: 7b13c093)
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r8_lr1e-04 (hash: cc916834)
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r4_lr2e-04 (hash: 3d608301)
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r32_lr1e-04 (hash: 8054b9a9)
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r4_lr2e-04 (hash: f1ee4565)
2025-09-20 10:24:25,541 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r32_lr5e-05 (hash: baf5e86d)
2025-09-20 10:24:25,542 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r16_lr2e-04 (hash: c1bea809)
2025-09-20 10:24:25,542 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r16_lr1e-04 (hash: 239a06ae)
2025-09-20 10:24:25,542 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r4_lr2e-04 (hash: 0ba659fd)
2025-09-20 10:24:25,542 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r8_lr2e-04 (hash: a448aa76)
2025-09-20 10:24:25,542 - loralab.core.lora_factory - INFO - Created unique variant: gen0_r8_lr1e-04 (hash: 2dec99bc)
2025-09-20 10:24:26,585 - loralab.core.unsloth_manager - INFO - LoRA variant created with Unsloth optimizations:
2025-09-20 10:24:26,586 - loralab.core.unsloth_manager - INFO -   Rank: 8, Alpha: 8 (multiplier: 1)
2025-09-20 10:24:26,586 - loralab.core.unsloth_manager - INFO -   Trainable params: 737,280 (0.27%)
2025-09-20 10:24:26,587 - loralab.core.unsloth_manager - INFO -   Gradient checkpointing: unsloth
2025-09-20 10:24:26,587 - loralab.core.unsloth_manager - INFO -   RSLoRA: True
2025-09-20 10:24:26,587 - loralab.evolution.evolutionary_trainer - INFO - Train data has 2000 total examples
2025-09-20 10:24:26,587 - loralab.evolution.evolutionary_trainer - INFO - Requesting 5 format examples
2025-09-20 10:24:26,587 - loralab.evolution.evolutionary_trainer - INFO - Actually got 5 format examples
2025-09-20 10:24:26,587 - loralab.evolution.evolutionary_trainer - INFO - Pre-training on format with 5 examples for 1 epochs
2025-09-20 10:24:26,587 - loralab.training.grpo_trainer - INFO - Pre-training model on format examples...
2025-09-20 10:24:26,629 - loralab.training.grpo_trainer - INFO - Pre-training configuration:
2025-09-20 10:24:26,630 - loralab.training.grpo_trainer - INFO -   - Examples: 5
2025-09-20 10:24:26,630 - loralab.training.grpo_trainer - INFO -   - Batch size: 1
2025-09-20 10:24:26,630 - loralab.training.grpo_trainer - INFO -   - Gradient accumulation: 2
2025-09-20 10:24:26,630 - loralab.training.grpo_trainer - INFO -   - Effective batch size: 2
2025-09-20 10:24:26,630 - loralab.training.grpo_trainer - INFO -   - Epochs: 1
2025-09-20 10:24:26,630 - loralab.training.grpo_trainer - INFO -   - Expected training steps: 5
2025-09-20 10:24:26,632 - loralab.training.grpo_trainer - INFO - Created pre-training dataset with 5 examples
2025-09-20 10:24:30,546 - loralab.training.grpo_trainer - INFO - Pre-training completed with final loss: 2.8983
2025-09-20 10:24:30,547 - loralab.training.grpo_trainer - INFO - Starting GRPO training for gen0_r8_lr1e-04
2025-09-20 10:24:41,634 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:24:41,634 - loralab.training.grpo_trainer - INFO -   Text: Here's how we can break down the problem step-by-step:

1. **Calculate the total score of the team:**
   * Riley's score: 3 mistakes
   * Ofelia's score: 5 more than Riley's score: 3 mistakes + 5 more mistakes = 8 mistakes

2. **Calculate the difference in scores:**
   * Riley's score - Ofelia's score = 3 mistakes - 8 mistakes = -5 mistakes

3. **Calculate the number of incorrect answers:**
   * T...
2025-09-20 10:24:41,635 - loralab.training.grpo_trainer - INFO -   Reward: -3.10 (range: -15 to +15)
2025-09-20 10:24:41,635 - loralab.training.grpo_trainer - INFO -   Expected answer: Riley's score is 35 - 3 = <<35-3=32>>32.
Half of Riley's score is 32/2 = <<32/2=16>>16.
So Ofelia's score is 16 + 5 = <<16+5=21>>21.
Hence, Ofelia got 35 - 21 = <<35-21=14>>14 incorrect answers.
Therefore, their team got 3 + 14 = <<3+14=17>>17 incorrect answers.
#### 17
2025-09-20 10:25:00,274 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:25:00,274 - loralab.training.grpo_trainer - INFO -   Text: Here's how we can solve this:

1. **Initial setup:** Lily has 5 tickets to sell.
2. **Selling the first ticket:** She sells the first ticket for $1.
3. **Selling each successive ticket:** She sells each successive ticket for $1 + $1 = $2.
4. **Profit:** She has $4 left over.
5. **Prize:** She gives the remaining $4 as the prize.

Therefore, the winner will receive $4.
...
2025-09-20 10:25:00,275 - loralab.training.grpo_trainer - INFO -   Reward: -3.30 (range: -15 to +15)
2025-09-20 10:25:00,275 - loralab.training.grpo_trainer - INFO -   Expected answer: The second ticket sold will cost $1 + $1 = $<<1+1=2>>2.
The third ticket sold will cost $2 + $1 = $<<2+1=3>>3.
The fourth ticket sold will cost $3 + $1 = $<<3+1=4>>4.
The fifth ticket sold will cost $4 + $1 = $<<4+1=5>>5.
The total money collected is $1 + $2 + $3 + $4 + $5 = $<<1+2+3+4+5=15>>15.
After taking profit, the total prize money will be $15 - $4 = $<<15-4=11>>11.
#### 11
2025-09-20 10:25:10,491 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:25:10,492 - loralab.training.grpo_trainer - INFO -   Text: Here's the breakdown:

1. **Calculate the number of cumulonimbus clouds:** 12 cumulonimbus clouds * 4 = 48 cumulonimbus clouds

2. **Calculate the total number of cirrus clouds:** 48 cumulonimbus clouds + 48 cumulonimbus clouds = 96 cirrus clouds

Therefore, there are 96 cirrus clouds in the sky at this moment....
2025-09-20 10:25:10,492 - loralab.training.grpo_trainer - INFO -   Reward: -3.10 (range: -15 to +15)
2025-09-20 10:25:10,492 - loralab.training.grpo_trainer - INFO -   Expected answer: The sky has 3*12=<<3*12=36>>36 cumulus clouds.
The sky has 4*36=<<4*36=144>>144 cirrus clouds.
#### 144
2025-09-20 10:25:34,527 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:25:34,527 - loralab.training.grpo_trainer - INFO -   Text: Here's how we can break down the problem step-by-step:

1. **Cost of Pineapples:** Jonah bought 6 pineapples for $3 each.
2. **Number of Rings:** Each pineapple could be cut into 12 pineapple rings.
3. **Selling Price:** Jonah sold 4 pineapple rings for $5 each.
4. **Profit:** Jonah made a profit of $5 - $5 = $0.

Therefore, Jonah made a profit of $0....
2025-09-20 10:25:34,527 - loralab.training.grpo_trainer - INFO -   Reward: -3.30 (range: -15 to +15)
2025-09-20 10:25:34,527 - loralab.training.grpo_trainer - INFO -   Expected answer: Jonah spent 6 x $3 = $<<6*3=18>>18
He made a total of 6 x 12 = <<6*12=72>>72 pineapple rings.
He sold 72/4 = <<72/4=18>>18 sets of pineapple rings.
He made 18 x $5 = $<<18*5=90>>90
His profit was $90 - $18 = $<<90-18=72>>72
#### 72
2025-09-20 10:25:58,576 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:25:58,576 - loralab.training.grpo_trainer - INFO -   Text: Here's the breakdown:

1. **Calculate the total revenue:**
   * Mrs. Oaklyn buys 20 rugs at $40 each.
   * Total revenue = 20 * $40 = $800

2. **Calculate the profit:**
   * Profit = Total revenue - Total cost
   * Profit = $800 - $40 = $760

Therefore, Mrs. Oaklyn will make a profit of $760 from selling the rugs.
...
2025-09-20 10:25:58,577 - loralab.training.grpo_trainer - INFO -   Reward: -3.10 (range: -15 to +15)
2025-09-20 10:25:58,577 - loralab.training.grpo_trainer - INFO -   Expected answer: Since she buys one rug at $40 and sells it at $60, she makes a profit of $60-$40 = $<<60-40=20>>20
If she bought 20 rugs at $40 and sold them at $60 each, she made a profit of 20*$20 = $400
#### 400
2025-09-20 10:26:03,517 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:26:03,518 - loralab.training.grpo_trainer - INFO -   Text: Here's the breakdown:

1. **Think:** The instructor spends thirty minutes on learning the first step.
2. **Reasoning:** The second step is mastered in half the time.
3. **Final Answer:** The instructor spent 30 minutes learning the three steps....
2025-09-20 10:26:03,518 - loralab.training.grpo_trainer - INFO -   Reward: -0.50 (range: -15 to +15)
2025-09-20 10:26:03,518 - loralab.training.grpo_trainer - INFO -   Expected answer: Arabella spent 30 / 2 = <<30/2=15>>15 minutes on the second step.
She took 30 + 15 = <<30+15=45>>45 minutes to learn the third step.
Therefore, Arabella spent 30 + 15 + 45 = <<30+15+45=90>>90 minutes learning all three steps.
#### 90
2025-09-20 10:26:07,170 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:26:07,171 - loralab.training.grpo_trainer - INFO -   Text: Here's how we can break down the problem step-by-step:

1. **Identify the number of boys:** 60 students * 28 boys/student = 1680 boys
2. **Identify the number of girls:** 50 students * 28 girls/student = 1400 girls
3. **Calculate the total number of students:** 1680 boys + 1400 girls = 2880 students

**Therefore, there are 2880 girls.**...
2025-09-20 10:26:07,171 - loralab.training.grpo_trainer - INFO -   Reward: -3.10 (range: -15 to +15)
2025-09-20 10:26:07,171 - loralab.training.grpo_trainer - INFO -   Expected answer: There are a total of 5 vans x 28 students = <<5*28=140>>140 students.
If 60 are boys, then 140 - 60 = <<140-60=80>>80 of these students are girls.
#### 80
2025-09-20 10:26:35,188 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:26:35,188 - loralab.training.grpo_trainer - INFO -   Text: Here's the step-by-step reasoning:

1. **Calculate the volume of the cube:**
   * Volume = side * side * side = 6 cm * 6 cm * 6 cm = 216 cubic centimeters

2. **Calculate the density of gold:**
   * Density = 19 grams per cubic centimeter = 19 * 1000 = 19000 grams/cm³

3. **Calculate the cost of the gold:**
   * Cost = 60 grams * $60/gram = $3600

4. **Calculate the selling price of the gold:**
  ...
2025-09-20 10:26:35,188 - loralab.training.grpo_trainer - INFO -   Reward: -0.30 (range: -15 to +15)
2025-09-20 10:26:35,188 - loralab.training.grpo_trainer - INFO -   Expected answer: The cube is 6*6*6=<<6*6*6=216>>216 cubic cm
So it has a mass of 216*19=<<216*19=4104>>4104 grams
So it uses 60*4104=$<<60*4104=246240>>246240
That means he sells it for 246240*1.5=$<<246240*1.5=369360>>369360
So he has a profit of 369360-246240=$<<369360-246240=123120>>123,120
#### 123120
2025-09-20 10:27:03,006 - loralab.training.grpo_trainer - INFO - [GRPO Reward] Sample completion (first 400 chars):
2025-09-20 10:27:03,006 - loralab.training.grpo_trainer - INFO -   Text: Here's the breakdown of the problem:

1. **Calculate the total number of pages needed:**
   * Book 1: 180 pages
   * Book 2: 100 pages

2. **Determine the number of pages needed for each book:**
   * Book 1: 180 pages / 2 pages/day = 90 days
   * Book 2: 100 pages / 2 pages/day = 50 days

3. **Calculate the number of days needed to read both books:**
   * Total days needed: 2 weeks * 7 days/week =...
2025-09-20 10:27:03,006 - loralab.training.grpo_trainer - INFO -   Reward: -3.30 (range: -15 to +15)
2025-09-20 10:27:03,006 - loralab.training.grpo_trainer - INFO -   Expected answer: The total number of pages is 180 + 100 = <<180+100=280>>280 pages
The number of pages Yasna needs to read every day for two weeks is 280 / 14 = <<280/14=20>>20 pages
#### 20
2025-09-20 10:27:13,675 - loralab.training.grpo_trainer - INFO - Available metrics: []
2025-09-20 10:27:13,675 - loralab.training.grpo_trainer - WARNING - No reward metric found in training output, defaulting to 0.0
2025-09-20 10:27:13,675 - loralab.training.grpo_trainer - INFO - GRPO training completed for gen0_r8_lr1e-04
2025-09-20 10:27:13,676 - loralab.training.grpo_trainer - INFO -   Final loss: 0.5498
2025-09-20 10:27:13,676 - loralab.training.grpo_trainer - INFO -   Average reward: 0.0000
